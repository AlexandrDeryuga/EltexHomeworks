Задание:
Смоделировать работу системы магазины-покупатели-рогрузчик

Не знаю, правильно ли я понял суть задания, и не обошел ли проблему блокировок
но в общем идея была такая:

- Создаем структуры на каждый объект,  при этом структура магазин  - это скорее объект данных
а структуры покупателя и погрузчика - это скорее объекты действия, которым надо разделить доступы к магазину

typedef struct Shop
{                          //структура данных по магазину, (!) пометим те которые важно менять через мьютекс
char Name[50];
int Free;                  //!  в принципе только это и критично, поскольку если флаг установлен в 0, никто другой обрабатывать эти данные больше не будет 
unsigned long Product;     
unsigned long Sold;        // сколько продано
char Status_ClientName[50];      //кем занят
unsigned int StatClientsCount;   //сколько клиентов обслуженно, 
unsigned int StatLoadsCount;  
float ClientTime;                //время обслуживания клиента на еденицу товара - добавим в модель для экспериментов
int Changed;                     //! тоже лучше под мьютекс но не критично, флаг того что можно печатать о себе информацию
}  Shop;


Поскольку в структуре есть флаг - "свободен"  
то тем самым мы автоматически разделяем доступ к всем остальным данным, кроме некоторых глобальных переменных
нужных для сбора статистики, а синхронизировать нам нужно лишь изменение флага, что и сделанно через мьютекс.

Тогда главная запускает 9 потоков, 5 на магазины ( они лишь печатают информацию о себе, если было изменение из вне) 3 на покупателей и один на погрузчик

Что бы было интересней ввел динамический параметр задержки, в принципе его можно занулить, что бы было к исходному текту задачи
Логика здесь следующая:
Покупатель блокирует магазин, но и магазин держит покупателя либо погрузчика, параметром динамической задержки.

Что еще - магазин старается восполнить свою потребность , а погрузчик старается равномерно загружать магазины
для этого в функции 
int FindFreeShop(Buyer *B, int startindex);
введен параметр startindex, в случае магазина он 0; в случае погрузчика - последний найденный
наверное нужно было увеличивать его на 1, но не стал усложнять

Пример работы программы

wh@wh-VirtualBox:~/Git/EltexHomeworks/TASK11$ ./d11ex3
Магазин1 товара 8973, время обслуживания покупателя на ед товара= 0.000010
Магазин2 товара 6202, время обслуживания покупателя на ед товара= 0.000010
Магазин3 товара 4625, время обслуживания покупателя на ед товара= 0.000010
Магазин4 товара 5469, время обслуживания покупателя на ед товара= 0.000010
Магазин5 товара 2038, время обслуживания покупателя на ед товара= 0.000010
Покупатель1 потребность 115072, Стационарное время блокировки магазина  2.000000
Покупатель2 потребность 139849, Стационарное время блокировки магазина  2.000000
Покупатель3 потребность 117802, Стационарное время блокировки магазина  2.000000
===========================================================================================
Загружено в магазины: 27307 , Общая потребность 372723 !
Параметры погрузчика:   время реакции (SleepTime 1.000000   Время погрузки =5000*0.000100 =0.500000
===========================================================================================
Главная - создаю потоки!
[198000] Я Магазин1, Начинаю обслуживание клиентов. Время обслуживания клиентов на ед товара 0.000010
[198000] Я Магазин1, товара на складе в кол-ве 8973 шт, мой статус: СВОБОДЕН  
[198001] Я Магазин2, Начинаю обслуживание клиентов. Время обслуживания клиентов на ед товара 0.000010
[198001] Я Магазин2, товара на складе в кол-ве 6202 шт, мой статус: СВОБОДЕН  
[198002] Я Магазин3, Начинаю обслуживание клиентов. Время обслуживания клиентов на ед товара 0.000010
[198002] Я Магазин3, товара на складе в кол-ве 4625 шт, мой статус: СВОБОДЕН  
[198003] Я Магазин4, Начинаю обслуживание клиентов. Время обслуживания клиентов на ед товара 0.000010
[198003] Я Магазин4, товара на складе в кол-ве 5469 шт, мой статус: СВОБОДЕН  
[198004] Я Магазин5, Начинаю обслуживание клиентов. Время обслуживания клиентов на ед товара 0.000010
[198004] Я Магазин5, товара на складе в кол-ве 2038 шт, мой статус: СВОБОДЕН  
[198005] Я Покупатель1, потребность в товаре 115072 шт, мой статус: Ищу свободный магазин
[198006] Я Покупатель2, потребность в товаре 139849 шт, мой статус: Ищу свободный магазин
[198007] Я Покупатель3, потребность в товаре 117802 шт, мой статус: Ищу свободный магазин
[198008] Я - Погрузчик, ищу свободный магазин.  Магазинов: 5, Клиентов 3
[198008] Я - Погрузчик: Найден  свободный магазин Магазин4, товаров 5469 отгружаю 5000 ед. товара
[198005] Я Покупатель1, потребность в товаре 115072 шт, мой статус: Найден  свободный магазин Магазин1, товаров 8973 отгружаю


....

[198007] Покупатель3 Потребность закрыта, ухожу с рынка (.)
[198001] Магазин2 Больше нет клиентов, закрываюсь (.)
[198002] Магазин3 Больше нет клиентов, закрываюсь (.)
[198000] Магазин1 Больше нет клиентов, закрываюсь (.)
[198004] Магазин5 Больше нет клиентов, закрываюсь (.)
[198003] Магазин4 Больше нет клиентов, закрываюсь (.)
Все 9 нитей завершились, время работы: 72.299594  сек.
Магазин1 , товаров 10000, продано товаров: 73973, всего погрузок 15
Магазин2 , товаров 0, продано товаров: 76202, всего погрузок 14
Магазин3 , товаров 0, продано товаров: 69625, всего погрузок 13
Магазин4 , товаров 0, продано товаров: 80469, всего погрузок 15
Магазин5 , товаров 19584, продано товаров: 72454, всего погрузок 18
Покупатель1 , потребность 0
Моя статистика:
Магазин1 покупок 5
Магазин2 покупок 2
Магазин3 покупок 6
Магазин4 покупок 5
Магазин5 покупок 4
Покупатель2 , потребность 0
Моя статистика:
Магазин1 покупок 4
Магазин2 покупок 9
Магазин3 покупок 4
Магазин4 покупок 5
Магазин5 покупок 7
Покупатель3 , потребность 0
Моя статистика:
Магазин1 покупок 6
Магазин2 покупок 3
Магазин3 покупок 5
Магазин4 покупок 5
Магазин5 покупок 8
Всего продано : 372723,  Всего потребность:372723
Всего погрузок в магазины : 75,  Всего погрузок погрузчиком:75




